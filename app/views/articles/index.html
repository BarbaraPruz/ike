<div class="row">
    <div class="col-sm-8">
        <h1>Articles</h1>
    </div>
    <div class="col-sm-4">
        <form>
       <!-- <form action="/articles/index_data" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" /> -->
            <select name='sort' id='sort'>
                <option   value=>Choose Sort Field</option>
                <option   value=topic>Topic</option>
                <option   value=title>Title</option>
                <option   value=helpful_count>Likes</option>
                <option   value=updated_at>Latest Update</option>
            <input id="sort_button" type="submit" name="commit" value="Sort" data-disable-with="Sort" />         
        </form>
    </div> 
</div>

<table class="table" id="articles_table">
    <thead>
        <tr>
            <th scope="col">Topic</th>
            <th scope="col">Title</th>
            <th scope="col">Likes</th>
            <th scope="col">Last Update</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>

<script type="text/javascript" charset="utf-8">
    function createArticleTable (articles) {
        console.log("Create Article Table");
        $("#articles_table tbody").empty();
        articles.forEach ( function (article) {
            let html = `<tr>`;
            let date = moment(`${article.updated_at}`).format("YYYY-MM-DD HH:mm");
            html += `<th scope="row">${article.topic.name}</th>`;
            html += `<td><a href="/articles/${article.id}">${article.title}</a></td>`;
            html += `<td>${article.helpful_count}</td>`;
            html += `<td>${date}</td>`;
            html += `</tr>`;
            $("#articles_table tbody").append(html);
        });
    }

    $(function() {
        console.log("Articles index - ready");
        $.get("/articles/index_data", createArticleTable);
        $("#sort_button").on("click", function(e) {
            e.preventDefault();
            $.get("/articles/index_data", { sort: `${$("#sort").val()}` }, createArticleTable);          
        });
    });
</script>